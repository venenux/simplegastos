' Gambas class file


Private $conn As Connection
'' ***********------    Configuración formulario PrincLogin           : -------*********

Public Sub Form_Open()
'mostrar el formulario con su propósito
  Me.Center
  Me.Caption = "INICIAR SESIÓN"
End

''determinar quien es y establecer variables de usuario y clave, si existen, hubo acceso positivo
Public Sub btnformloginok_Click()

  Dim login, password As String
  Dim contain As New Containerdataoasis
  Dim acceso As Boolean = False
  Dim loginok As Boolean = False
  Dim passok As Boolean = False
  Dim pos As Integer = 0
  Dim rs As Collection  


  If IsNull(informloginUsername.Text) Or IsNull(informloginUserpass.Text) Then
    Message.Warning("¡No deje ningún cuadro vacío!")
  Else
     '    primero veremos si se permite el ingreso... 
      '      
        login = informloginUsername.Text 
        password = informloginUserpass.Text
       ' credenciales(Optional ulogin As String = "", Optional uclave As String = "", Optional ubicacion As String = "") As Collection
       rs = contain.credenciales(login, password)
        If Val(rs["resultado"]) = 1 Then
          ' usuario checkeado en bd, sus datos serán mandados a todos los formularios 
          MMain.get_credentials(rs)
               acceso = True
        Else
          Print "se fue todo al /dev/null "
        Endif

   
    
  Endif
 
    If acceso = True Then 
      ' invocar  el formulario FInicial.form 
         FInicial.show 
         Me.close
     Endif    
End

Public Sub btnformloginCancel_Click()
  
  Me.Close
  
End

Public Sub informloginUsername_KeyPress()
  
  If (key.Code = 65421 Or Key.Code = Key.Return) Then
    informloginUserpass.SetFocus
  Endif     
  
End

Public Sub informloginUserpass_KeyPress()
  
  If (key.Code = 65421 Or Key.Code = Key.Return) Then
    btnformloginok_Click
  Endif
  
End
